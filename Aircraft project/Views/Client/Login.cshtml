@model Aircraft_project.Models.Users

@{
    ViewData["Title"] = "Login";

    // Check if login was successful
    bool loginSuccess = TempData["SuccessMessage"] != null;
}

<style>
    .bgg {
        background-image: url("https://miro.medium.com/v2/resize:fit:1400/1*hS59XJEpKW3vx_pVsFuk-g.jpeg");
        background-size: cover;
        background-position: center;
        background-repeat: no-repeat;
    @*height:100vh;*@
    }
</style>

<section class="vh-100 d-flex align-items-center justify-content-center bgg">
    <div class="container">
        <div class="row shadow text-secondary ">
            <div class="col-md-6 shadow p-5 rounded bg-light">
                <h2 class="font-weight-bold">LOGIN FORM</h2>
                <hr class="mb-5">
                <form asp-action="Login" asp-controller="Client" method="post">
                    <div class="mb-4">
                        <label for="loginEmail" class="form-label">Email Address</label>
                        <input type="email" class="form-control" id="loginEmail" name="Email" required
                            placeholder="Enter your email">
                    </div>

                    <div class="mb-4">
                        <label for="loginPassword" class="form-label">Password</label>
                        <input type="password" class="form-control" id="loginPassword" name="Password" required
                            placeholder="Enter your password">
                    </div>

                    <div class="d-grid gap-2">
                        <button type="submit" class="btn btn-primary btn-lg">Login</button>
                    </div>
                    <p class="mt-4 mb-4"> Are you a new member? Please <a class="" asp-controller="Client"
                            asp-action="Register">Create an Account</a> </p>
                </form>
            </div>
            <div class="col-md-6">
                <img src="https://www.blraerospace.com/wp-content/uploads/2016/07/H125_Products_2.png"
                    alt="Raythos Aerospace Hangar" class="img-fluid w-100 img_transistion">
            </div>
        </div>
    </div>
</section>

@* @section Scripts {
<script>
// Function to set items in local storage with expiration time
function setLocalStorageItem(key, value, expirationDays) {
const expirationDate = new Date();
expirationDate.setDate(expirationDate.getDate() + expirationDays);
const item = {
value: value,
expirationDate: expirationDate.toISOString()
};
localStorage.setItem(key, JSON.stringify(item));
}

// Set user ID and username in local storage
setLocalStorageItem('UserID', '@ViewData["UserID"]', 14);
setLocalStorageItem('UserName', '@ViewData["UserName"]', 14);
</script>
} *@

@section Scripts {
    @if (loginSuccess)
    {
        <script>
            // Function to set items in local storage with expiration time
            function setLocalStorageItem(key, value, expirationDays) {
                const expirationDate = new Date();
                expirationDate.setDate(expirationDate.getDate() + expirationDays);
                const item = {
                    value: value,
                    expirationDate: expirationDate.toISOString()
                };
                localStorage.setItem(key, JSON.stringify(item));
            }

            // Get user ID and username from ViewData
            const userID = '@ViewData["UserID"]';
            const userName = '@ViewData["UserName"]';

            // Debugging: Log the values to the console
            console.log('UserID:', userID);
            console.log('UserName:', userName);

            // Set user ID and username in local storage
            setLocalStorageItem('UserID', userID, 14);
            setLocalStorageItem('UserName', userName, 14);

            window.location.href = '/';
        </script>
    }
}
